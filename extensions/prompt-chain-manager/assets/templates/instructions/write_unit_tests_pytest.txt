Write comprehensive unit tests for the following Python code using the pytest framework. Cover edge cases and main functionality.
