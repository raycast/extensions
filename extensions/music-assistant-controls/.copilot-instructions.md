# GitHub Copilot Custom Instructions

## Project Context

This is a Raycast extension for controlling Music Assistant, a home music server system. The extension provides menu bar controls and commands for music playback, player selection, and volume control.

## Code Quality Standards

### Testing Philosophy

- **Always write unit tests** - Don't forget tests like a "junior developer"
- **Proper test organization**: Put client tests in client test files, command-specific tests in command test files
- **Clean test files**: Remove unused imports, variables, and mock configurations
- **Comprehensive coverage**: Test both success and error cases

### Code Organization

- **Respect existing file structure**: Don't put tests in wrong files
- **Clean imports**: Group and organize import statements properly
- **No scattered imports**: Consolidate related imports together
- **Remove unused code**: Clean up unused variables, imports, and dependencies

### API Integration Patterns

- **Use existing patterns**: Follow established command patterns (play-pause, next-song, etc.)
- **Error handling**: Always handle API errors gracefully with try/catch
- **API exploration**: When APIs don't work as expected, investigate the actual available methods
- **Raycast-specific**: Use React Form components instead of imperative prompts (prompt() doesn't exist in Raycast)

### User Experience

- **Smart UI**: Only show controls for supported features (e.g., volume controls only for players that support them)
- **Visual feedback**: Use appropriate icons and status indicators
- **Real-time updates**: Refresh data when changes are made
- **Non-intrusive design**: Features should integrate naturally without overwhelming the interface

## Technical Stack

- **Framework**: Raycast extension using TypeScript and React
- **Testing**: Jest with comprehensive mocking
- **External API**: Music Assistant WebSocket API
- **UI Components**: Raycast's MenuBarExtra, Form, ActionPanel components
- **State Management**: useCachedPromise for API data, useLocalStorage for preferences

## Development Workflow

- **Environment**: Use nvm to manage Node.js versions (follow .nvmrc)
- **Dependencies**: Run npm install after Node.js version changes
- **Testing**: Run tests after implementation and cleanup
- **Validation**: Test extension in development mode to ensure functionality
- **Pre-publish checks**: test, lint and build are automatically run before publishing via `prepublish` script
- **Publishing**: Use `npm run publish` (not `npm publish`) to publish to Raycast Store

## Code Style Preferences

- **Documentation**: Write comprehensive JSDoc comments for public methods
- **Error messages**: Provide clear, actionable error messages
- **Method naming**: Use descriptive names that indicate purpose and return type
- **Type safety**: Use TypeScript types properly, import from interfaces when needed

## Documentation Standards

- **Update CHANGELOG.md**: Always update changelog with new features, fixes, and improvements
- **Update README.md**: Keep feature documentation current, add new commands and capabilities
- **Accuracy is critical**: Verify all technical details and UI descriptions before writing
- **User-focused language**: Focus on what users experience, not implementation details
- **Concise descriptions**: Keep changelog entries brief and to the point
- **Test functionality**: Verify features work as described before documenting them
- **Consistent detail level**: Don't elaborate on individual features in README - treat all commands equally in the table format
- **No feature favoritism**: Avoid creating special detailed sections for specific features unless all features get the same treatment

## Changelog Format

- **Use Raycast placeholder**: Use `{PR_MERGE_DATE}` instead of hardcoded dates - Raycast replaces this when PR is merged
- **Title format**: `## [Descriptive Title] - {PR_MERGE_DATE}`
- **Square brackets**: Always use square brackets around the version/title
- **Dash spacing**: Use `-` (space-dash-space) between title and date placeholder
- **Content structure**: Organize changes with clear headers (‚ú® New Features, üîß Technical Improvements, üé® UI/UX Enhancements)
- **Example format**:

  ```markdown
  ## [Volume Control Features] - {PR_MERGE_DATE}

  ### ‚ú® New Features

  - Feature description
  ```

## Music Assistant Specific

- **Player vs Queue**: Understand the distinction between players and queues
- **Volume control**: Check `volume_control` property before showing volume features
- **State management**: Use appropriate Music Assistant API methods for different operations
- **Real-time data**: Subscribe to updates and refresh cached data when needed

## UI/UX Guidelines

- **Menu bar design**: Use sections, separators, and submenus for logical grouping
- **Progressive disclosure**: Start with essential controls, use submenus for advanced features
- **Status indicators**: Show current state (playing/paused, volume level, mute status)
- **Feedback**: Provide user feedback for actions (toasts, HUD messages)

## Anti-patterns to Avoid

- ‚ùå Writing client tests in command test files
- ‚ùå Using prompt() or other non-existent Raycast APIs
- ‚ùå Forgetting to write tests
- ‚ùå Leaving unused imports or variables
- ‚ùå Ignoring error cases in tests
- ‚ùå Showing UI controls for unsupported features
- ‚ùå Hard-coding values that should be dynamic
