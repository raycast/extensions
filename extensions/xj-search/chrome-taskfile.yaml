version: "3"

vars:
  CHROME_OPEN: 'open -a "Google Chrome"'

  CURRENT_TIMESTAMP:
    sh: "date +%s"
  PAST_TIMESTAMP:
    sh: "date -v-15M +%s"

  CLOUD_CN_PROD: "https://cloud.bytedance.net"
  CLOUD_I18N_PROD: "https://cloud-i18n.bytedance.net"

  # argos
  ARGOS_KEYWORD_CN_PROD_URL: ""
  ARGOS_AGGREGATE_CN_PROD_URL: ""

  TEMP_BYTECYCLE_URL: ""

tasks:
  tce:bti_iocinfo:cn:prod:
    vars:
      TI_ES_CN_PROD_URL: "https://cloud.bytedance.net/tce/services/72116?cluster-type=cluster&module=cluster&page=1&page_size=10"
    cmd: '{{.CHROME_OPEN}} "{{.TI_ES_CN_PROD_URL}}"'

  tce:bti_iocinfo:i18n:prod:
    vars:
      TI_ES_I18N_PROD_URL: "https://cloud-i18n.bytedance.net/tce/services/5731?cluster-type=cluster&module=cluster&page=1&page_size=10"
    cmd: '{{.CHROME_OPEN}} "{{.TI_ES_I18N_PROD_URL}}"'

  tce:bti_iocinfo:boe:prod:
    vars:
      BOE_CN_PROD_URL: "https://cloud-boe.bytedance.net/tce/services/67619?cluster-type=cluster&module=cluster&page=1&page_size=10"
    cmd: '{{.CHROME_OPEN}} "{{.BOE_CN_PROD_URL}}"'

  bmq:iocshotstatus:cn:prod:
    vars:
      BMQ_IOCSHOTSTATUS_CN_PROD_URL: "https://cloud.bytedance.net/message-queue/topics/57794/detail?region=online&active_tab=consumer"
    cmd: '{{.CHROME_OPEN}} "{{.BMQ_IOCSHOTSTATUS_CN_PROD_URL}}"'

  bmq:ti_event:cn:prod:
    vars:
      BMQ_TI_EVENT_CN_PROD_URL: "https://cloud.bytedance.net/message-queue/topics/57438/detail?region=online&active_tab=consumer"
    cmd: '{{.CHROME_OPEN}} "{{.BMQ_TI_EVENT_CN_PROD_URL}}"'

  faas:ti_event_to_bytees:cn:prod:
    vars:
      FAAS_TI_EVENT_TO_BYTEES_CN_PROD_URL: "https://cloud.bytedance.net/faas/function/4sybdfmq/cluster/detail?cluster=faas-cn-north&region=cn-north"
    cmd: '{{.CHROME_OPEN}} "{{.FAAS_TI_EVENT_TO_BYTEES_CN_PROD_URL}}"'

  faas:ioc_threatbk_lookup:cn:prod:
    desc: security.ioc.threatbk_lookup
    vars:
      FAAS_IOC_THREATBK_LOOKUP_CN_PROD_URL: "https://cloud.bytedance.net/faas/function/ohc6zmth/detail"
    cmd: '{{.CHROME_OPEN}} "{{.FAAS_IOC_THREATBK_LOOKUP_CN_PROD_URL}}"'

  git_repo:ioc_threatbk_lookup:
    desc: security.ioc.threatbk_lookup
    vars:
      GIT_REPO_IOC_THREATBK_LOOKUP_URL: "https://code.byted.org/security/ioc_threatbk_lookup"
    cmd: '{{.CHROME_OPEN}} "{{.GIT_REPO_IOC_THREATBK_LOOKUP_URL}}"'

  bmq:security_ti_threatb_event:cn:prod:
    vars:
      BMQ_SECURITY_TI_THREATB_EVENT_CN_PROD_URL: "https://cloud.bytedance.net/message-queue/topics/993519/detail?region=online"
    cmd: '{{.CHROME_OPEN}} "{{.BMQ_SECURITY_TI_THREATB_EVENT_CN_PROD_URL}}"'

  bmq:ti_es:cn:prod:
    vars:
      BMQ_TI_ES_CN_PROD_URL: "https://cloud.bytedance.net/message-queue/topics/931447/detail?region=online"
    cmd: '{{.CHROME_OPEN}} "{{.BMQ_TI_ES_CN_PROD_URL}}"'

  bmq:bti_eval_engine_trigger:cn:prod:
    vars:
      BMQ_BTI_EVAL_ENGINE_TRIGGER_CN_PROD_URL: "https://cloud.bytedance.net/message-queue/topics/57434/detail?region=online&active_tab=consumer"
    cmd: '{{.CHROME_OPEN}} "{{.BMQ_BTI_EVAL_ENGINE_TRIGGER_CN_PROD_URL}}"'

  event:ioc_event:cn:prod:
    vars:
      EVENT_IOC_EVENT_CN_PROD_URL: "https://cloud.bytedance.net/eventbus_cn/eventv2/ioc_event?region=CN"
    cmd: '{{.CHROME_OPEN}} "{{.EVENT_IOC_EVENT_CN_PROD_URL}}"'

  netlink:ti_sec:cn:prod:
    vars:
      NETLINK_CN_PROD_URL: "https://cloud.bytedance.net/netlink/main/namespace/insert-manage?ns=7452&show_type=domain&tdm_domain=ti-sec.bytedance.net&tdm_servername=26208"
    desc: "ti-sec.bytedance.net"
    cmd: '{{.CHROME_OPEN}} "{{.NETLINK_CN_PROD_URL}}"'

  netlink:ioc:cn:prod:
    desc: "ioc.bytedance.net"
    vars:
      NETLINK_CN_PROD_URL: "https://cloud.bytedance.net/netlink/main/namespace/insert-manage?ns=4594"
    cmd: '{{.CHROME_OPEN}} "{{.NETLINK_CN_PROD_URL}}"'

  tce:iocinforestful:cn:prod:
    desc: security.bti.iocinforestful
    vars:
      TCE_IOCINFORESTFUL_CN_PROD_URL: "https://cloud.bytedance.net/tce/services/73781"
    cmd: '{{.CHROME_OPEN}} "{{.TCE_IOCINFORESTFUL_CN_PROD_URL}}"'

  git_repo:iocinforestful:
    desc: security.bti.iocinforestful
    vars:
      GIT_REPO_IOCINFORESTFUL_URL: "https://code.byted.org/security/iocinforestful"
    cmd: '{{.CHROME_OPEN}} "{{.GIT_REPO_IOCINFORESTFUL_URL}}"'

  faas:analysis_engine:cn:prod:
    vars:
      FAAS_ANALYSIS_ENGINE_CN_PROD_URL: "https://cloud.bytedance.net/faas/function/it1kw8xs/cluster/detail?cluster=faas-cn-north&region=cn-north"
    cmd: '{{.CHROME_OPEN}} "{{.FAAS_ANALYSIS_ENGINE_CN_PROD_URL}}"'

  faas:bti_eval_engine:cn:prod:
    desc: "security.bti.eval_engine"
    vars:
      FAAS_BTI_EVAL_ENGINE_CN_PROD_URL: "https://cloud.bytedance.net/faas/function/iwhd0a2e/cluster/detail"
    cmd: '{{.CHROME_OPEN}} "{{.FAAS_BTI_EVAL_ENGINE_CN_PROD_URL}}"'

  faas:offline_analysis:cn:prod:
    vars:
      FAAS_OFFLINE_ANALYSIS_CN_PROD_URL: "https://cloud.bytedance.net/faas/function/it1kw8xs/cluster/trigger?cluster=faas-cn-north&region=cn-north#undefined"
    cmd: '{{.CHROME_OPEN}} "{{.FAAS_OFFLINE_ANALYSIS_CN_PROD_URL}}"'

  dorado:space:cn:prod:
    vars:
      DORADO_SPACE_CN_PROD_URL: "https://data.bytedance.net/dorado/development/node/101716761?project=cn_1233&version=-1"
    cmd: '{{.CHROME_OPEN}} "{{.DORADO_SPACE_CN_PROD_URL}}"'

  dorado:ioc_api_log_offline:cn:prod:
    vars:
      DORADO_IOC_API_LOG_OFFLINE_CN_PROD_URL: "https://data.bytedance.net/dorado/development/node/104309708?project=cn_1233"
    cmd: '{{.CHROME_OPEN}} "{{.DORADO_IOC_API_LOG_OFFLINE_CN_PROD_URL}}"'

  hive:ti_ioc_log_offline:cn:prod:
    vars:
      HIVE_IOC_LOG_OFFLINE_CN_PROD_URL: "https://data.bytedance.net/coral/datamap/detail?groupName=default&guid=38e36edc-c2d4-4ee2-a08f-adca2b7a50e6&qualifiedName=HiveTable%3A%2F%2F%2Fsecurity%2Fti_ioc_log_offline%400&subTab=schema#group=default"
    cmd: '{{.CHROME_OPEN}} "{{.HIVE_IOC_LOG_OFFLINE_CN_PROD_URL}}"'

  dorado:ods_bti_iocshots:cn:prod:
    vars:
      DORADO_IOC_API_LOG_OFFLINE_CN_PROD_URL: "https://data.bytedance.net/dorado/development/node/111335843?project=cn_1233"
    cmd: '{{.CHROME_OPEN}} "{{.DORADO_IOC_API_LOG_OFFLINE_CN_PROD_URL}}"'

  hive:ods_bti_iocshots:cn:prod:
    vars:
      HIVE_IOC_LOG_OFFLINE_CN_PROD_URL: "https://data.bytedance.net/coral/datamap/detail/table_info/HiveTable/security_threat_intelligence/ods_bti_iocshots/schema#group=default"
    cmd: '{{.CHROME_OPEN}} "{{.HIVE_IOC_LOG_OFFLINE_CN_PROD_URL}}"'

  clickhouse:bti_iocshots:cn:prod:
    vars:
      CLICKHOUSE_IOC_LOG_OFFLINE_CN_PROD_URL: "https://data.bytedance.net/coral/datamap/detail?groupName=default&qualifiedName=ClickhouseTable%3A%2F%2F%2Fbytesecurity%2Fbti_iocshots%400&subTab=schema&tab=table_info#group=default"
    cmd: '{{.CHROME_OPEN}} "{{.CLICKHOUSE_IOC_LOG_OFFLINE_CN_PROD_URL}}"'

  clickhouse:security_ti_event:cn:prod:
    vars:
      CLICKHOUSE_SECURITY_TI_EVENT_CN_PROD_URL: "https://data.bytedance.net/coral/datamap/detail?groupName=default&qualifiedName=ClickhouseTable%3A%2F%2F%2Fbytesecurity%2Fsecurity_ti_event%400&subTab=schema&tab=table_info#group=default"
    cmd: '{{.CHROME_OPEN}} "{{.CLICKHOUSE_SECURITY_TI_EVENT_CN_PROD_URL}}"'

  databus:security_ioc_log:cn:prod:
    vars:
      DATABUS_SECURITY_IOC_LOG_CN_PROD_URL: "https://cloud.bytedance.net/databus/cluster/cluster_detail?cluster=security_ioc_log&region=cn-north-1"
    cmd: '{{.CHROME_OPEN}} "{{.DATABUS_SECURITY_IOC_LOG_CN_PROD_URL}}"'

  bmq:security_bti_update:cn:prod:
    vars:
      BMQ_SECURITY_BTI_UPDATE_CN_PROD_URL: "https://cloud.bytedance.net/message-queue/topics/59500/detail?region=online&active_tab=consumer"
    cmd: '{{.CHROME_OPEN}} "{{.BMQ_SECURITY_BTI_UPDATE_CN_PROD_URL}}"'

  tce:bti_platform:cn:prod:
    vars:
      TCE_BTI_PLATFORM_CN_PROD_URL: "https://cloud.bytedance.net/tce/services/81769"
    cmd: '{{.CHROME_OPEN}} "{{.TCE_BTI_PLATFORM_CN_PROD_URL}}"'

  mongo:ti:cn:prod:
    desc: bytedance.bytedoc.ti
    vars:
      MONGO_TI_CN_PROD_URL: "https://cloud.bytedance.net/bytedoc/classic/database/ti/overview?region=CN"
    cmd: '{{.CHROME_OPEN}} "{{.MONGO_TI_CN_PROD_URL}}"'
