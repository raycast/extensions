ğŸ›  Refactor Guide

â€œNotebookLM Ã— Raycastâ€ ì½”ë“œë² ì´ìŠ¤ë¥¼ ì•ˆì „í•˜ê²Œ ê°ˆì•„ì—ëŠ” ì´ìœ ì™€ ë°©ë²•

â¸»

1. ì™œ ê³ ì³ì•¼ í•˜ë‚˜?

ë¬¸ì œ	ì¦ìƒ	ì˜í–¥
React ê·œì¹™ ìœ„ë°˜	í›…(getNotebooksFromArc)ì„ ì¼ë°˜ í•¨ìˆ˜(getNotebooks) ë‚´ë¶€ì—ì„œ í˜¸ì¶œ	- StrictModeÂ·í…ŒìŠ¤íŠ¸Â·ë¦¬ë¡œë“œ ì‹œ ë¬´ì¡°ê±´ ê²½ê³  ë˜ëŠ” í¬ë˜ì‹œ
ê´€ì‹¬ì‚¬ ë’¤ì„ì„	UI ë ˆì´ì–´ì—ì„œ ë¸Œë¼ìš°ì € íƒ­ì„ ë§Œë“¤ê³  AppleScript ì‹¤í–‰	ìœ ì§€ë³´ìˆ˜Â·í…ŒìŠ¤íŠ¸ ë‚œì´ë„ ê¸‰ìƒìŠ¹, ë‹¤ë¥¸ ë¸Œë¼ìš°ì € ì§€ì› ê±°ì˜ ë¶ˆê°€
ì¤‘ë³µÂ·ë ˆì´ì–´ ëˆ„ë½	browserAction.ts, ì—¬ëŸ¬ í›…, AppleScript í˜¸ì¶œ ìœ„ì¹˜ê°€ ì—¬ê¸°ì €ê¸° í©ì–´ì§	ì–´ë””ê°€ ë°ì´í„° ì†ŒìŠ¤ì¸ì§€ ì°¾ê¸° ì–´ë ¤ì›€
í™•ì¥ì„± ì œë¡œ	Chrome/Safari ëŒ€ì‘ì„ ì‹œì‘í•˜ë ¤ë©´ UIë¥¼ ì£„ë‹¤ ëœ¯ì–´ì•¼ í•¨	ìƒˆ ê¸°ëŠ¥ì´ ê¸°íšë˜ë©´ ë§¤ë²ˆ ëŒ€ê³µì‚¬

ëª©í‘œ
	1.	ì„œë¹„ìŠ¤(ë°ì´í„°/íƒ­ ì œì–´) â†”ï¸ UI(ìƒíƒœ/ë Œë”ë§) ì™„ì „ ë¶„ë¦¬
	2.	ë¸Œë¼ìš°ì €ë³„ ì–´ëŒ‘í„°ë§Œ êµì²´í•˜ë©´ UIëŠ” ê·¸ëŒ€ë¡œ ì‚¬ìš©
	3.	í…ŒìŠ¤íŠ¸Â·StrictModeÂ·ë™ì‹œ ê°œë°œ í™˜ê²½ì—ì„œ ì•ˆì „í•˜ê²Œ ë™ì‘

â¸»

2. ìƒˆ êµ¬ì¡° í•œëˆˆì—

â”Œâ”€ React UI â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ show-notebook.tsx  (ì»´í¬ë„ŒíŠ¸)          â”‚
â”‚ useNotebooks.ts    (ì»¤ìŠ¤í…€ í›…)          â”‚
â””â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 â”‚  INotebookService (í¬íŠ¸ / ì¸í„°í˜ì´ìŠ¤)
â”Œâ”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ArcNotebookService   ChromeNotebookâ€¦  â”‚ â—€â”€â”€â”€ ë¸Œë¼ìš°ì € ì–´ëŒ‘í„°
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

	â€¢	INotebookService â€“ íƒ­ ì—´ê¸°â€§ë‹«ê¸°Â·ëª©ë¡ ì¡°íšŒÂ·ìš”ì•½ ì¡°íšŒë¥¼ ì •ì˜
	â€¢	ArcNotebookService â€“ AppleScript í˜¸ì¶œ ë° JSON íŒŒì‹± ë‹´ë‹¹
	â€¢	useNotebooks â€“ ë¡œë”©Â·ë¦¬í”„ë ˆì‹œÂ·ì—ëŸ¬ ìƒíƒœë§Œ ê´€ë¦¬ (í›… ê·œì¹™ 100% ì¤€ìˆ˜)
	â€¢	ì‡¼ ë…¸íŠ¸ë¶ ì»´í¬ë„ŒíŠ¸ â€“ í›…ë§Œ ì‚¬ìš©, íƒ­/ìŠ¤í¬ë¦½íŠ¸ì™€ëŠ” ì ˆì—°

â¸»

3. ì§„í–‰ ìˆœì„œ & ì²´í¬ë¦¬ìŠ¤íŠ¸

ë‹¨ê³„ 1~5 ëŠ” ì½”ë“œ ì¶”ê°€ë§Œ, 6Â·7Â·8Â·10Â·11 ì—ì„œ ì‹¤ì œ ë™ì‘ì´ ë°”ë€ë‹ˆë‹¤.
ë§¤ ë‹¨ê³„ í›„ ë°˜ë“œì‹œ npm run lint && npm run typecheck && npm test && ray run ë¡œ í™•ì¸í•˜ì„¸ìš”.

#	ì‘ì—…	ì£¼ìš” íŒŒì¼	ë¹Œë“œ ì˜í–¥
1	INotebookService ì¸í„°í˜ì´ìŠ¤ ì¶”ê°€	services/notebook/INotebookService.ts	âŒ
2	ArcNotebookService 1ì°¨ êµ¬í˜„ (openTabÂ·closeTabÂ·list)	services/notebook/ArcNotebookService.ts	âŒ
3	ì„œë¹„ìŠ¤ íŒ©í† ë¦¬ ìƒì„±	services/notebook/factory.ts	âŒ
4	useNotebooks í›… ì´ˆì•ˆ (list only)	hooks/useNotebooks.ts	âŒ
5	(ì„ íƒ) í›… ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ëª¨í‚¹	__tests__/â€¦	âŒ
6	show-notebook ì»´í¬ë„ŒíŠ¸ â†’ useNotebooks ì ìš©	show-notebook.tsx	âœ…
7	useNotebooks ì— tabIdÂ·closeTab ì¶”ê°€ â†’ ì»´í¬ë„ŒíŠ¸ ë°˜ì˜	hooks/useNotebooks.ts	âœ…
8	getNotebooks í˜¸ì¶œ ì „ë©´ ì œê±°	ì—¬ëŸ¬ ì»´í¬ë„ŒíŠ¸	âœ…
9	browserAction.ts ì¶•ì†Œ (export ìœ ì§€)	hooks/browserAction.ts	âŒ
10	AppleScript ë¶€ìˆ˜íš¨ê³¼ë¥¼ ArcNotebookServiceë¡œ ì™„ì „ ì´ì „	hooks/browser/arc.ts, services/...	âœ…
11	browserAction.ts ì‚­ì œ + import ê²½ë¡œ êµì²´	ì „ì—­	âœ…
12	dead-code, eslint fix	ì „ì—­	âŒ
13	README / ë¬¸ì„œ ì—…ë°ì´íŠ¸	README.md	âŒ


â¸»

4. ì„¸ë¶€ ì‘ì—… ê°€ì´ë“œ

4-1. ì¸í„°í˜ì´ìŠ¤ & ì„œë¹„ìŠ¤

// services/notebook/INotebookService.ts
export interface INotebookService {
  openTab(): Promise<string | null>;
  closeTab(tabId: string): Promise<null>;
  list(): Promise<Notebook[]>;
  summary(tabId: string, noteId: string, srcId: string): Promise<Summary>;
}

// services/notebook/ArcNotebookService.ts
export class ArcNotebookService implements INotebookService {
  async openTab()   { return await makeNotebookLMTab(); }
  async closeTab(id){ await runAppleScriptActionOnTab(id, "close"); return null; }
  async list()      { const raw = await fetchData(await this.openTab()); return formatNotebook(raw).notebooks; }
  async summary(t,n,s){ return await fetchSummaryfromArc(t,n,s); }
}

4-2. í›…

// hooks/useNotebooks.ts
export function useNotebooks() {
  const [isLoading,setLoading]=useState(true);
  const [notebooks,setNotebooks]=useState<Notebook[]>([]);
  const tabIdRef=useRef<string|null>(null);

  const load=useCallback(async()=>{
    setLoading(true);
    try{
      if(!tabIdRef.current) tabIdRef.current=await notebookService.openTab();
      setNotebooks(await notebookService.list());
    }finally{ setLoading(false); }
  },[]);

  useEffect(()=>{ load(); },[load]);

  return {
    tabId: tabIdRef.current,
    notebooks,
    isLoading,
    refresh: load,
    closeTab: async()=>{ if(tabIdRef.current) await notebookService.closeTab(tabIdRef.current); }
  };
}

4-3. ì»´í¬ë„ŒíŠ¸ êµì²´

// show-notebook.tsx
const { tabId, notebooks, isLoading, refresh, closeTab } = useNotebooks();

	â€¢	useEffect ë‚´ì—ì„œ closeTab() í˜¸ì¶œ
	â€¢	refreshContent â†’ refresh ë³€ê²½

â¸»

5. Git ë¸Œëœì¹˜ & ì»¤ë°‹ ì „ëµ
	1.	ê¸°ëŠ¥ë³„ ë¸Œëœì¹˜

git checkout -b feat/notebook-service
# ë‹¨ê³„ 1~3
git commit -m "feat(core): introduce notebook service architecture"


	2.	ì»´íŒŒì¼Â·ëŸ°íƒ€ì„ í†µê³¼ ë³´ì¦
	â€¢	ê° ì»¤ë°‹ ì „ì— npm run build (RaycastëŠ” ray build)
	â€¢	ìµœì†Œ 1ê°œì˜ ìŠ¤ëª¨í¬ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
	3.	PR ë‹¨ìœ„
	â€¢	1~5ë²ˆ ë¬¶ì–´ â€˜infraâ€™ PR â†’ ë¨¸ì§€
	â€¢	6~8ë²ˆ ë¬¶ì–´ â€˜UI migrationâ€™ PR
	â€¢	10~11ë²ˆ â€˜service cut-overâ€™ PR
ë¬¸ì œê°€ ìƒê¸°ë©´ PR ë‹¨ìœ„ë¡œ ë¡¤ë°± ê°€ëŠ¥
	4.	ë¦´ë¦¬ì¦ˆ íƒœê·¸
	â€¢	UI ë§ˆì´ê·¸ë ˆì´ì…˜ ì™„ë£Œ ì‹œ vX.Y.0-beta1
	â€¢	browserAction ì œê±° ì™„ë£Œ ì‹œ vX.Y.0 ì •ì‹

â¸»

6. FAQ

ì§ˆë¬¸	ë‹µë³€
ê¸°ì¡´ getNotebooksFromArcëŠ” ì§€ìš°ë‚˜ìš”?	AppleScript í˜¸ì¶œë§Œ ê±·ì–´ë‚´ê³  íŒŒì‹± ì „ìš© í•¨ìˆ˜ ë¡œ ë‚¨ê¹ë‹ˆë‹¤. í›—ë‚  CLI ë“±ì—ì„œ ì¬ì‚¬ìš© ê°€ëŠ¥.
Chrome/Safari ì§€ì›ì€?	ChromeNotebookService, SafariNotebookServiceë§Œ êµ¬í˜„í•˜ë©´ UI ë¬´ë³€ê²½ìœ¼ë¡œ ë™ì‘.
ë¦¬íŒ©í„° ë„ì¤‘ ë¹Œë“œ ê¹¨ì§€ë©´?	ë‹¨ê³„ ì²´í¬ë¦¬ìŠ¤íŠ¸ë¥¼ ê±´ë„ˆë›´ ê²ƒ. ì»¤ë°‹ ì „ì— git stash && git checkout HEAD~1 ë¡œ ë˜ëŒì•„ê°€ í™•ì¸í•˜ì„¸ìš”.


â¸»

7. ëìœ¼ë¡œ

ì´ë²ˆ ë¦¬íŒ©í„°ëŠ” â€œê´€ì‹¬ì‚¬ ë¶„ë¦¬â€ ì™€ â€œì•ìœ¼ë¡œì˜ í™•ì¥ì„±Â·ì•ˆì •ì„±â€ ì„ ìœ„í•œ í•„ìˆ˜ ì‘ì—…ì…ë‹ˆë‹¤.
â˜‘ï¸ ì‘ì€ ì»¤ë°‹ â˜‘ï¸ í…ŒìŠ¤íŠ¸ ìš°ì„  â˜‘ï¸ ì£¼ì„ & PR ì„¤ëª… ì„¸ ì›ì¹™ë§Œ ì§€í‚¤ë©´ ì•ˆì „í•˜ê²Œ ì™„ë£Œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ì§ˆë¬¸Â·ì´ìŠˆëŠ” #dev-notebook-refactor ìŠ¬ë™ ì±„ë„ì— ë°”ë¡œ ì˜¬ë ¤ ì£¼ì„¸ìš”. Happy hacking! ğŸ‰