import { OpenRouterModel } from "../types";

const BASE_ICON_URL = "https://unpkg.com/@lobehub/icons-static-svg@1.47.0/icons";

const ICONS = [
  "adobe-color",
  "adobe",
  "adobefirefly-color",
  "adobefirefly",
  "ai21-brand-color",
  "ai21-brand",
  "ai21",
  "ai360-color",
  "ai360",
  "aihubmix-color",
  "aihubmix",
  "aimass-color",
  "aimass",
  "aionlabs-color",
  "aionlabs",
  "aistudio-color",
  "aistudio",
  "alephalpha",
  "alibaba-brand-color",
  "alibaba-brand",
  "alibaba-color",
  "alibaba",
  "alibabacloud-color",
  "alibabacloud",
  "antgroup-brand-color",
  "antgroup-brand",
  "antgroup-color",
  "antgroup",
  "anthropic",
  "anyscale-color",
  "anyscale",
  "assemblyai-color",
  "assemblyai",
  "automatic-color",
  "automatic",
  "aws-brand-color",
  "aws-brand",
  "aws-color",
  "aws",
  "aya-color",
  "aya",
  "azure-color",
  "azure",
  "azureai-color",
  "azureai",
  "baai",
  "baichuan-color",
  "baichuan",
  "baidu-brand-color",
  "baidu-brand",
  "baidu-color",
  "baidu",
  "baiducloud-color",
  "baiducloud",
  "bedrock-color",
  "bedrock",
  "bing-color",
  "bing",
  "bytedance-brand-color",
  "bytedance-brand",
  "bytedance-color",
  "bytedance",
  "centml-brand-color",
  "centml-brand",
  "centml-color",
  "centml",
  "cerebras-brand-color",
  "cerebras-brand",
  "cerebras-color",
  "cerebras",
  "chatglm-color",
  "chatglm",
  "civitai-color",
  "civitai",
  "claude-color",
  "claude",
  "cline",
  "clipdrop",
  "cloudflare-color",
  "cloudflare",
  "codegeex-color",
  "codegeex",
  "cogvideo-color",
  "cogvideo",
  "cogview-color",
  "cogview",
  "cohere-color",
  "cohere",
  "colab-color",
  "colab",
  "comfyui-color",
  "comfyui",
  "commanda-color",
  "commanda",
  "copilot-color",
  "copilot",
  "coqui-color",
  "coqui",
  "coze",
  "crewai-brand-color",
  "crewai-brand",
  "crewai-color",
  "crewai",
  "crusoe-color",
  "crusoe",
  "cursor",
  "dalle-color",
  "dalle",
  "dbrx-brand-color",
  "dbrx-brand",
  "dbrx-color",
  "dbrx",
  "deepai",
  "deepinfra-color",
  "deepinfra",
  "deepmind-color",
  "deepmind",
  "deepseek-color",
  "deepseek",
  "dify-color",
  "dify",
  "doc2x-color",
  "doc2x",
  "docsearch-color",
  "docsearch",
  "doubao-color",
  "doubao",
  "dreammachine",
  "exa-color",
  "exa",
  "fal",
  "fastgpt-color",
  "fastgpt",
  "featherless-color",
  "featherless",
  "fireworks-color",
  "fireworks",
  "fishaudio",
  "flora",
  "flowith",
  "flux",
  "friendli",
  "gemini-brand-color",
  "gemini-brand",
  "gemini-color",
  "gemini",
  "gemma-color",
  "gemma",
  "giteeai",
  "github",
  "githubcopilot",
  "glif",
  "google-brand-color",
  "google-brand",
  "google-color",
  "google",
  "goose",
  "gradio-color",
  "gradio",
  "greptile-color",
  "greptile",
  "grok",
  "groq",
  "hailuo-color",
  "hailuo",
  "haiper",
  "hedra",
  "higress-color",
  "higress",
  "huggingface-color",
  "huggingface",
  "hunyuan-color",
  "hunyuan",
  "hyperbolic-color",
  "hyperbolic",
  "ideogram",
  "iflytekcloud-color",
  "iflytekcloud",
  "inference",
  "infermatic-color",
  "infermatic",
  "infinigence-color",
  "infinigence",
  "inflection",
  "internlm-color",
  "internlm",
  "jimeng-color",
  "jimeng",
  "jina-color",
  "jina",
  "kera",
  "kimi-color",
  "kimi",
  "kling-color",
  "kling",
  "kluster-color",
  "kluster",
  "lambda",
  "langchain-color",
  "langchain",
  "langfuse-color",
  "langfuse",
  "langgraph-color",
  "langgraph",
  "langsmith-color",
  "langsmith",
  "leptonai-color",
  "leptonai",
  "lightricks",
  "liquid",
  "livekit-color",
  "livekit",
  "llamaindex-color",
  "llamaindex",
  "llava-color",
  "llava",
  "lmstudio",
  "lobehub-color",
  "lobehub",
  "luma-color",
  "luma",
  "magic",
  "make-color",
  "make",
  "manus",
  "mcp",
  "meta-brand-color",
  "meta-brand",
  "meta-color",
  "meta",
  "metaai-color",
  "metaai",
  "metagpt",
  "microsoft-color",
  "microsoft",
  "midjourney",
  "minimax-color",
  "minimax",
  "mistral-color",
  "mistral",
  "modelscope-color",
  "modelscope",
  "monica-color",
  "monica",
  "moonshot",
  "myshell-color",
  "myshell",
  "n8n-color",
  "n8n",
  "nebius",
  "notebooklm",
  "notion",
  "nova-color",
  "nova",
  "novita-color",
  "novita",
  "nplcloud-color",
  "nplcloud",
  "nvidia-color",
  "nvidia",
  "ollama",
  "openai",
  "openchat-color",
  "openchat",
  "openrouter",
  "openwebui",
  "palm-color",
  "palm",
  "parasail",
  "perplexity-color",
  "perplexity",
  "phidata-color",
  "phidata",
  "pika",
  "pixverse-color",
  "pixverse",
  "poe-color",
  "poe",
  "pollinations",
  "ppio-brand-color",
  "ppio-brand",
  "ppio-color",
  "ppio",
  "pydanticai-color",
  "pydanticai",
  "qingyan-color",
  "qingyan",
  "qiniu-color",
  "qiniu",
  "qwen-color",
  "qwen",
  "railway",
  "recraft",
  "replicate-brand",
  "replicate",
  "replit-color",
  "replit",
  "rsshub-color",
  "rsshub",
  "runway",
  "rwkv-color",
  "rwkv",
  "sambanova-color",
  "sambanova",
  "search1api-color",
  "search1api",
  "searchapi",
  "sensenova-brand-color",
  "sensenova-brand",
  "sensenova-color",
  "sensenova",
  "siliconcloud-color",
  "siliconcloud",
  "snowflake-color",
  "snowflake",
  "spark-color",
  "spark",
  "stability-brand-color",
  "stability-brand",
  "stability-color",
  "stability",
  "statecloud-color",
  "statecloud",
  "stepfun-color",
  "stepfun",
  "suno",
  "sync",
  "targon-color",
  "targon",
  "tencent-brand-color",
  "tencent-brand",
  "tencent-color",
  "tencent",
  "tencentcloud-color",
  "tencentcloud",
  "tiangong-color",
  "tiangong",
  "tii-color",
  "tii",
  "together-brand-color",
  "together-brand",
  "together-color",
  "together",
  "topazlabs",
  "tripo-color",
  "tripo",
  "udio-color",
  "udio",
  "unstructured-color",
  "unstructured",
  "upstage-color",
  "upstage",
  "v0",
  "vectorizerai",
  "vercel",
  "vertexai-color",
  "vertexai",
  "vidu-color",
  "vidu",
  "viggle",
  "vllm-color",
  "vllm",
  "volcengine-color",
  "volcengine",
  "voyage-color",
  "voyage",
  "wenxin-color",
  "wenxin",
  "workersai-color",
  "workersai",
  "xai",
  "xinference-color",
  "xinference",
  "xuanyuan-color",
  "xuanyuan",
  "yandex",
  "yi-color",
  "yi",
  "yuanbao-color",
  "yuanbao",
  "zapier-color",
  "zapier",
  "zeabur-color",
  "zeabur",
  "zeroone",
  "zhipu-color",
  "zhipu",
];

function findIcon(searchTerms: string[]): string | undefined {
  return ICONS.find((icon) => searchTerms.some((term) => icon === `${term}-color` || icon === term));
}

function removeCommonSuffixes(provider: string): string {
  return provider.replaceAll(/-?(ai|llama)$/g, "");
}

function normalizeProvider(provider: string): string {
  // Remove dashes from provider names for better icon matching
  return provider.replace(/-/g, "");
}

export function getModelIcon(model: OpenRouterModel) {
  const tokenizer = model.architecture.tokenizer.toLowerCase();
  const provider = model.id.split("/")[0]?.toLowerCase();
  const normalizedProvider = normalizeProvider(provider || "");
  const providerWithoutSuffix = removeCommonSuffixes(normalizedProvider);

  let icon: string | undefined;

  if (tokenizer === "claude" && provider === "anthropic") {
    icon = "claude-color";
  } else {
    icon = findIcon([normalizedProvider, providerWithoutSuffix, tokenizer]);
  }

  if (icon) {
    return `${BASE_ICON_URL}/${icon}.svg`;
  }
  return;
}

export function getProviderIcon(providerId: string): string | undefined {
  const provider = providerId.toLowerCase();
  const normalizedProvider = normalizeProvider(provider);
  const providerWithoutSuffix = removeCommonSuffixes(normalizedProvider);

  const icon = findIcon([normalizedProvider, providerWithoutSuffix]);

  if (icon) {
    return `${BASE_ICON_URL}/${icon}.svg`;
  }
  return undefined;
}
