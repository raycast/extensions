{
  "evals": [
    {
      "input": "@raydocs what's the file structure of an extension?",
      "mocks": {
        "get-link-content": "| Description |\n| --- |\n| Understand the file structure of an extension. |\n\n\n\n# File Structure\n\nAn extension consists of at least an entry point file (e.g. `src/index.ts`) and a `package.json` manifest file. We add a few more support files when scaffolding an extension to streamline development with modern JavaScript tooling.\n\nThe typical directory structure of a newly created extension looks like this:\n\n```bash\nextension\n├── .eslintrc.json\n├── .prettierrc\n├── assets\n│   └── icon.png\n├── node_modules\n├── package-lock.json\n├── package.json\n├── src\n│   ├── command.tsx\n└── tsconfig.json\n```\n\nThe directory contains all source files, assets, and a few support files. Let's go over each of them:\n\n## Sources\n\nPut all your source files into the `src` folder. We recommend using TypeScript as a programming language. Our API is fully typed, which helps you catch errors at compile time rather than runtime. `ts`, `tsx`, `js` and `jsx` are supported as file extensions. As a rule of thumb, use `tsx` or `jsx` for commands with a UI.\n\nAn extension consists of at least an entry point file (e.g. `src/command.ts`) per command and a `package.json` manifest file holding metadata about the extension, its commands, and its tools. The format of the manifest file is very similar to [that of npm packages](https://docs.npmjs.com/cli/v7/configuring-npm/package-json). In addition to some of the standard properties, there are some [additional properties](https://developers.raycast.com/information/manifest), in particular, the `commands` properties which describes the entry points exposed by the extension.\n\nEach command has a property `name` that maps to its main entry point file in the `src` folder. For example, a command with the name `create` in the `package.json` file, maps to the file `src/create{.ts,.tsx,.js,.jsx}`.\n\n## Assets\n\nThe optional `assets` folder can contain icons that will be packaged into the extension archive. All bundled assets can be referenced at runtime. Additionally, icons can be used in the `package.json` as extension or command icons.\n\n## Support files\n\nThe directory contains a few more files that setup common JavaScript tooling:\n\n- **eslint.config.js** describes rules for [ESLint](https://eslint.org), which you can run with `npm run lint`. It has recommendations for code style and best practices. Usually, you don't have to edit this file.\n- **.prettierrc** contains default rules for [Prettier](https://prettier.io) to format your code. We recommend to setup the [VS Code extension](https://prettier.io/docs/en/editors.html#visual-studio-code) to keep your code pretty automatically.\n- **node_modules** contains all installed dependencies. You shouldn't make any manual changes to this folder.\n- **package-lock.json** is a file generated by npm to install your dependencies. You shouldn't make any manual changes to this file.\n- **package.json** is the [manifest file](https://developers.raycast.com/information/manifest) containing metadata about your extension such as its title, the commands, and its dependencies.\n- **tsconfig.json** configures your project to use TypeScript. Most likely, you don't have to edit this file.\n",
        "get-links": [
          {
            "id": "d7a576c6-fe96-451e-8082-90ab19f23641",
            "sectionTitle": "Examples",
            "title": "Spotify Controls",
            "url": {
              "external": false,
              "markdown": "https://raw.githubusercontent.com/raycast/extensions/refs/heads/main/docs/examples/spotify-controls.md",
              "path": "https://developers.raycast.com/examples/spotify-controls"
            }
          },
          {
            "id": "a3700e3a-08d8-443d-928b-8d0198750e4b",
            "sectionTitle": "Information",
            "title": "Terminology",
            "url": {
              "external": false,
              "markdown": "https://raw.githubusercontent.com/raycast/extensions/refs/heads/main/docs/information/terminology.md",
              "path": "https://developers.raycast.com/information/terminology"
            }
          },
          {
            "id": "d7ee0a53-2e13-4c60-a7a4-681e0b60bfd7",
            "sectionTitle": "Information",
            "title": "File Structure",
            "url": {
              "external": false,
              "markdown": "https://raw.githubusercontent.com/raycast/extensions/refs/heads/main/docs/information/file-structure.md",
              "path": "https://developers.raycast.com/information/file-structure"
            }
          }
        ]
      },
      "expected": [
        {
          "callsTool": {
            "name": "get-links"
          }
        },
        {
          "callsTool": {
            "name": "get-link-content",
            "arguments": {
              "markdownUrl": "https://raw.githubusercontent.com/raycast/extensions/refs/heads/main/docs/information/file-structure.md"
            }
          }
        }
      ]
    },
    {
      "input": "@raydocs how to run something in the background",
      "mocks": {
        "get-link-content": "# Background Refresh\n\nCommands of an extension can be configured to be automatically run in the background, without the user manually opening them.\nBackground refresh can be useful for:\n\n- dynamically updating the subtitle of a command in Raycast root search\n- refreshing menu bar commands\n- other supporting functionality for your main commands\n\nThis guide helps you understand when and how to use background refresh and learn about the constraints.\n\n## Scheduling Commands\n\nRaycast supports scheduling commands with mode `no-view` and `menu-bar` at a configured interval.\n\n### Manifest\n\nAdd a new property `interval` to a command in the [manifest](https://developers.raycast.com/information/manifest#command-properties)\n\nExample:\n\n```json\n{\n    \"name\": \"unread-notifications\",\n    \"title\": \"Show Unread Notifications\",\n    \"description\": \"Shows the number of unread notifications in root search\",\n    \"mode\": \"no-view\",\n    \"interval\": \"10m\"\n},\n```\n\nThe interval specifies that the command should be launched in the background every X seconds (s), minutes (m), hours (h) or days (d). Examples: `10m`, `12h`, `1d`. The minimum value is 10 seconds (`10s`), which should be used cautiously, also see the section on best practices.\n\nNote that the actual scheduling is not exact and might vary within a tolerance level. macOS determines the best time for running the command in order to optimize energy consumption, and scheduling times can also vary when running on battery. To prevent overlapping background launches of the same command, commands are terminated after a timeout that is dynamically adjusted to the interval.\n\n## Running in the background\n\nThe entry point of your command stays the same when launched from the background. For no-view commands, a command will run until the Promise of the main async function resolves. Menu bar commands render a React component and run until the `isLoading` property is set to `false`.\n\nYou can use the global `environment.launchType` in your command to determine whether the command has been launched by the user (`LaunchType.UserInitiated`) or via background refresh (`LaunchType.Background`).\n\n```typescript\nimport { environment, updateCommandMetadata } from \"@raycast/api\";\n\nasync function fetchUnreadNotificationCount() {\n  return 10;\n}\n\nexport default async function Command() {\n  console.log(\"launchType\", environment.launchType);\n  const count = await fetchUnreadNotificationCount();\n  await updateCommandMetadata({ subtitle: `Unread Notifications: ${count}` });\n}\n```\n\nRaycast auto-terminates the command if it exceeds its maximum execution time. If your command saves some state that is shared with other commands, make sure to use defensive programming, i.e. add handling for errors and data races if the stored state is incomplete or inaccessible.\n\n## Development and Debugging\n\nFor local commands under development, errors are shown as usual via the console. Two developer actions in root search help you to run and debug scheduled commands:\n\n- Run in Background: this immediately runs the command with `environment.launchType` set to `LaunchType.Background`.\n- Show Error: if the command could not be loaded or an uncaught runtime exception was thrown, the full error can be shown in the Raycast error overlay for development. This action is also shown to users of the installed Store command and provides actions to copy and report the error on the production error overlay.\n\n![](https://raw.githubusercontent.com/raycast/extensions/refs/heads/main/docs/.gitbook/assets/background-refresh-error.webp)\n\nWhen the background run leads to an error, users will also see a warning icon on the root search command and a tooltip with a hint to show the error via the Action Panel. The tooltip over the subtitle of a command shows the last run time.\n\nYou can launch the built-in root search command \"Extension Diagnostics\" to see which of your commands run in background and when they last ran.\n\n## Preferences\n\nFor scheduled commands, Raycast automatically adds command preferences that give users the options to enable and disable background refresh. Preferences also show the last run time of the command.\n\n![](https://raw.githubusercontent.com/raycast/extensions/refs/heads/main/docs/.gitbook/assets/background-refresh-preferences.webp)\n\nWhen a user installs the command via the Store, background refresh is initially _disabled_ and is activated either when the user opens the command for the first time or enables background refresh in preferences. (This is to avoid automatically running commands in the background without the user being aware of it.)\n\n## Best Practices\n\n- Make sure the command is useful both when manually launched by the user or when launched in the background\n- Choose the interval value as high as possible - low values mean the command will run more often and consume more energy\n- If your command performs network requests, check the rate limits of the service and handle errors appropriately (e.g. automatically retry later)\n- Make sure the command finishes as quickly as possible; for menu bar commands, ensure `isLoading` is set to false as early as possible\n- Use defensive programming if state is shared between commands of an extension and handle potential data races and inaccessible data\n",
        "get-links": [
          {
            "id": "5ad6a592-94d7-4e3b-a83a-1af32bf5869a",
            "sectionTitle": "Information",
            "title": "Background Refresh",
            "url": {
              "external": false,
              "markdown": "https://raw.githubusercontent.com/raycast/extensions/refs/heads/main/docs/information/lifecycle/background-refresh.md",
              "path": "https://developers.raycast.com/information/lifecycle/background-refresh"
            }
          },
          {
            "id": "896e2c4b-2271-4f41-9ee9-98d412de2994",
            "sectionTitle": "Information",
            "title": "Deeplinks",
            "url": {
              "external": false,
              "markdown": "https://raw.githubusercontent.com/raycast/extensions/refs/heads/main/docs/information/lifecycle/deeplinks.md",
              "path": "https://developers.raycast.com/information/lifecycle/deeplinks"
            }
          },
          {
            "id": "5b541504-1c31-43ed-b63f-e58f6dd52521",
            "sectionTitle": "Information",
            "title": "Best Practices",
            "url": {
              "external": false,
              "markdown": "https://raw.githubusercontent.com/raycast/extensions/refs/heads/main/docs/information/best-practices.md",
              "path": "https://developers.raycast.com/information/best-practices"
            }
          },
          {
            "id": "03141675-4519-4e15-9b6e-89522d8320c5",
            "sectionTitle": "Information",
            "title": "Developer Tools",
            "url": {
              "external": false,
              "markdown": "https://raw.githubusercontent.com/raycast/extensions/refs/heads/main/docs/information/developer-tools/README.md",
              "path": "https://developers.raycast.com/information/developer-tools"
            }
          }
        ]
      },
      "expected": [
        {
          "callsTool": {
            "name": "get-links"
          }
        },
        {
          "callsTool": {
            "name": "get-link-content",
            "arguments": {
              "markdownUrl": "https://raw.githubusercontent.com/raycast/extensions/refs/heads/main/docs/information/lifecycle/background-refresh.md"
            }
          }
        }
      ]
    }
  ]
}
